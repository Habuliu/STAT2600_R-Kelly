---
title: "Lab9"
author: "R-Kelly"
date: "March 6, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lubridate)
#library(OpenStreetMap)
library(dplyr)
library(readr)
library(forcats)
library(data.table)
```

```{r}
#Gregor Import
#stations_locations <- read.csv("C:\\Users\\Gregor\\Documents\\College\\Data Science\\Homeworks\\Lab #9\\Nice_Ride_2017_Station_Locations.csv", header = TRUE)

#Lauren Import
station_locations <- read_csv("Nice_Ride_2017_Station_Locations.csv")
```

```{r}
#Gregor Import
#trip_history <- read.csv("C:\\Users\\Gregor\\Documents\\College\\Data Science\\Homeworks\\Lab 9\\Nice_ride_trip_history_2017_season.csv")

#Lauren Import
trip_history <- read_csv("Nice_ride_trip_history_2017_season.csv")
```


#Individual Sections

### Gregor


Joining into new data set

```{r}
start_locations <- select(trip_history, Start.date:Start.station, Account.type:Total.duration..Seconds.)
colnames(start_locations)[2] <- "Name"
start_locations_joined <- left_join(start_locations, stations_locations, by = "Name")
start_locations_joined$Number <- NULL
colnames(start_locations_joined)[4] <- "secondsDuration"
start_locations_joined <- mutate(start_locations_joined, Hours = secondsDuration / (60*60))

location_calculations <- aggregate(Hours~Name, start_locations_joined, FUN = sum)
location_calculations <- left_join(stations_locations, location_calculations, by = "Name")
```


Graphing

```{r}
ggplot() + # Plots a map 
  geom_point(data=location_calculations, 
               aes(x=Longitude, y=Latitude, size = Hours), 
               color = 'blue') +
  labs(x='Longitude', y='Latitude') +
  ggtitle('Hour total from each station')
```




I made a graph that showed which stations have accumulated the most hours rode from. I created a ggplot that has x and y as longitude and latitude, and a size aesthetic that shows duration of all of the ride lengths summed up at this station. Hence, the plotted points show the location of each station. The greater the plotted point, the longer the ride time the station is responsble for.

###Lauren

```{r}
totaldata<- full_join(station_locations,trip_history,by = c("Number" = "Start station number"))
totaldata$`Station Name` <- totaldata$`Start station`
totaldata$`Date` <- totaldata$`Start date`
totaldata<- totaldata %>% select(`Number`, `Start station`, `Latitude`, `Longitude`, `Total docks`,`Date`)
totaldata <- totaldata %>% 
  mutate(Year = year(mdy_hm(Date)), Month = month(mdy_hm(Date)), Day = day(mdy_hm(Date)))
```




#Team Findings

