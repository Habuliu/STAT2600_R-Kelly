title: "lab14"
author: R-Kelly
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
source("http://www.openintro.org/stat/data/cdc.R")
cdc <- as_tibble(cdc)
```
# Team section
### Our Question
Our team decided to investigate the relationship between smoking, age and general health.  It is interesting and important to explore this relationship as it can give a better understanding to the effects of smoking. This answer will be interesting and important as it may lead to a better general health for the community. 
PLOT:
```{r}
ggplot(data  = cdc) + 
    geom_boxplot(mapping = aes(x  = genhlth, y = age)) +
    facet_wrap(~ smoke100, nrow = 2)
```
### Our Recommendation
We can see form the graph that people who smoke less have a higher chance of having a good health even in their older ages. So we think smoke does affect health in some extent. We recommend no smoking is the best.
# Individual Plots

### Lauren
I chose to investigate the relationship between general health and age, and the differences of this relationship for men and women. I found that females we're on average slightly healthier than men independed of age, and people from age 30 to 50 we're the heathiest group of people. 

```{r}
ggplot(data = cdc) +  geom_histogram(bins=20, mapping = aes(x = age, fill = genhlth)) +facet_wrap(~gender) +
  xlab("Age") +
  ylab("People") +
  labs(title= "General Health by Age for both Men and Women")


```

### Ping:
Question: Do people who do exercises, having health plan, no smoking, maintain a better weight? Maintaing a better weight means having a less different between their actual weight and desired weight. 

Ho: If people who do exercises, have health plan, dont smoke, then there still a difference between their actual weight and desired weight.
H1: If people who do exercises, have health plan, dont smoke, there is no difference between their actual weight and desired weight.

```{r}
perm_cor <- function(perms = 1000, weight, wtdesired)
{
 vector <- c(rep(0,perms))

 # Loop throught number of permutations
 for (i in c(1:perms))
 {
   # Step 2:
   # Randomly mix up the values in the vector "y"
   wtdesired <- sample(wtdesired, length(wtdesired))

   # Step 3:
   # Compute the correlation between x and the randomly mixed
   # up y-vector. Store this value in the vector from step 1.
   vector[i] <- cor(wtdesired, weight)
 }

 # Step 4:
 # Return new updated vector, created in step 1
 return(vector)
}
```

```{r}
cdc <- cdc %>% mutate(diff = wtdesire - weight)
cdc_training <- cdc %>% filter(exerany == "1", smoke100 == "0", hlthplan == "1")

ggplot(data = cdc_training, mapping = aes( x =diff)) + geom_histogram(color = "black", fill = "pink")

correlation <- perm_cor(perms = 1000, cdc_training$weight, cdc_training$wtdesire)
correlation <- data.frame(correlation)
cor <- cor(cdc_training$weight, cdc_training$wtdesire)

#true_value = mean(cdc$diff)
ggplot(correlation) + geom_density(aes(x = correlation)) + geom_vline(aes(xintercept=cor), linetype="dashed", size=1)


```
From the first graph, we can see that most people who do exercises, have health plan, and dont smoke have 0 difference between their actual weight and their desire weight. From the second graph, we can see that the actual correlation is way away from the graph, so it is very significant. So we can confidently reject the null. Thus if people who do exercises, have health plan, dont smoke, there is no difference between their actual weight and desired weight.

### Peter
I chose to examine the correlation between smoking, height, and weight. Since healthy weight is dependent on a number of factors, I figured the best measure of general fitness is the difference between actual and desired weight. The graph is separated by gender and smoking status, to show the difference in health between populations. 
```{r, warning = FALSE, message = FALSE}
pcdc <- cdc
pcdc <- pcdc%>% mutate(wdelta = weight-wtdesire)
valueAssign <- function(string){
  val <- 0
  if(string == "excellent"){
    val <- 5
  }
  else if(string == "very good"){
    val <- 4
  
  }
  else if(string == "good"){
    val <- 3
  }
  else if(string == "fair"){
    val <- 2
  }
  else if(string == "poor"){
    val <- 1
  }
  else{
    val <- -1
  }
  return(val)
}
pcdc <- pcdc %>% mutate(inthlth = map(genhlth, valueAssign))

ggplot(pcdc, aes(x = height, y = wdelta, color = genhlth)) +
     geom_hex() +
    
    facet_grid(gender ~ smoke100)
    
```
A trend shown by the graph is the higher likelyhood of un-fit smokers being of fair or poor health. Non-smoking populations tend to have more individuals in the overweight range who's health is fair or good. Another notable trait is the higher than average health of the tallest members of each subgroup. Lastly, there is a clear trend between smoking and being of poor health. What a surprise. 





## Sasha:

```{r}
library(modelr)
library(tidyverse)
source("http://www.openintro.org/stat/data/cdc.R")
cdc <- as_tibble(cdc)
```


```{r}

options(na.action = na.warn)

cdcN<- na.omit(cdc)

cdc2 <- lm(wtdesire ~ weight, data = cdcN)
coef(cdc2)

cdcN <- cdcN %>% 
  add_residuals(cdc2)

ggplot(data = cdcN, aes(x = wtdesire, fill = gender))+
  geom_density() +
  facet_wrap("genhlth") +
  xlim( 0 , 300)+
  geom_vline(aes(xintercept = mean(wtdesire)), color = "black", linetype = "solid", size = 1)+
  xlab("Weight Desire")+
  ylab("Density")

ggplot(data = cdcN, aes(x = resid, fill = gender))+
  geom_density()+
  facet_wrap("genhlth")+
  xlim(-100, 100)+
  geom_vline(aes(xintercept = mean(resid)), color = "black", linetype = "solid", size = 1)+
  xlab("Residuals")+
  ylab("Density")

```
I chose to examine the relationship between weight, weight desire and how those are 
affected by gender and general health. Through the use of a linear model I was able 
to graph the residuals of weight desire and actual weight. This reveals that people 
who are in better health tend to be closer to their ideal wight and as health levels 
decrease, people tend to be further from their ideal weight. Another interesting 
revelation presented in these graohs is that women tend to to want to weigh less than 
they do while men tend to want to weigh more.

## Gregor:

My graph shows the impact that smoking and exercise has on your general health. The graphs inside the facet wrap show the different amounts of people 
in each health status. With each graph, however, the data represents a different population of the dataset, with one of graphs representing either:
1. People who don't smoke, nor exercise
2. People who do smoke, but don't exercise
3. People who don't smoke, but do exercise
4. People who do smoke, but do exercise









## R Markdown


The graphs show that whether one exercises has a bigger impact on one's general health. In the graphs that show the people who have exercised in the past 
month (meaning of the 'exerany' variable), the ratio between excellent and very good status to fair and poor is much greater than the same ratio in the graphs of people
who don't smoke. The fact that this ratio is still much greater in the people who smoke and exercise in comparison to this same ratio in the people who smoke but don't 
exercise demonstrates that exercise has a bigger impact on general health. In the two graphs that show the people that don't smoke, the ratios between good 
health and poor health is about the same, whether the person smokes or not. 

```{r}
ggplot(data  = cdc, mapping = aes(x  = genhlth)) + geom_bar() + facet_wrap(exerany~smoke100, labeller = label_both)
``` 
#Who Did What!

Lauren: In this team Lab, I worked on formatting the document and fixing code so all of the plots would print when the file was knit. I also worked on developing and writing the team question for our plot. 
Ping: I did the team plot and recommendations.





