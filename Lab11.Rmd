---
title: "Lab11"
author: "R Kelly"
date: "4/3/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(babynames)
srcbabynames<-(babynames::babynames)
```

```{r}
#make your own version of the data by assigning a new variable to the srcbabynames data object
babynamesPersonal <- srcbabynames
babynames<-(babynames::babynames)
Megan <- filter(babynames,str_detect(babynames$name, "Megan")) %>% group_by(year) %>% summarize(sumprop=sum(prop))

ggplot(data=Megan) +
  geom_line(aes(x=year,y=sumprop)) +
  ggtitle("Total proportion of US babies named \"Megan\"")

```

#Team

```{r}
filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1988,sex=="F") %>% count(wt=prop) #0.000841196	

filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1990,sex=="F") %>% count(wt=prop) #0.002612356	
```

Deciding on list of A girl names
```{r}
Agirls1 <- filter(babynames,str_detect(babynames$name,"A"),year==1988,sex=="F")
Agirls2 <- filter(babynames,str_detect(babynames$name,"A"),year==1990,sex=="F")

Agirls <- inner_join(Agirls1,Agirls2,by="name") %>% mutate(diff=prop.y-prop.x) %>% select(name,prop.x,prop.y,diff)

Ariel.diff <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1990,sex=="F") %>% count(wt=prop) - filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1988,sex=="F") %>% count(wt=prop)

ggplot(Agirls) +
 geom_histogram(aes(x=Ariel.diff),bins=100) + 
 geom_vline(aes(xintercept=Ariel.diff),color="red",lwd=1) 
```

```{r}
Rachel <- filter(babynames,str_detect(babynames$name,"Ra[ey]?ch.*l"),year%in%c(1973,1988,1990)) %>% filter(name!="Rachelann") %>% filter(name!="Rachelanne")

Rachel.diff <- filter(Rachel,year==1990,sex=="F") %>% count(wt=prop) - filter(Rachel,year==1988,sex=="F") %>% count(wt=prop) #-0.001888172

ggplot(Agirls) +
 geom_histogram(aes(x=diff),bins=100) + 
 geom_vline(aes(xintercept=Ariel.diff),color="red",lwd=1)+
  geom_vline(aes(xintercept=Rachel.diff),color="blue",lwd=1)
```



#Individual

###Lauren

```{r}
babynamesLauren <- babynamesPersonal
babynamesL<-(babynames::babynames)
Lauren <- filter(babynamesL,str_detect(babynamesL$name, "L[ao][^ie]r[ey]n+[^a]?$")) %>% group_by(year) %>% summarize(sumprop=sum(prop))

ggplot(data=Lauren) +
  geom_line(aes(x=year,y=sumprop)) +
  ggtitle("Total proportion of US babies named a version of \"Lauren\"")

Laurensincebirth <- filter(Lauren,year>1998)

ggplot(data=Laurensincebirth) +
  geom_line(aes(x=year,y=sumprop)) +
  ggtitle("Total proportion of US babies named a version of \"Lauren\" since 1998")

```

From looking at the proportion of US babies named a version of "Lauren", it is interesting to note the peak of people named "Lauren" occured before 1998, the year I was born. Since then, there has been a significant decrease in the number of people named Lauren. It would be interesting to investigate the same question, but separate the babies into male and female. The proportion of babies with a first name that starts with Lau, began to significantly rise near the 1950's, and again, has significantly decreased since 1998.

