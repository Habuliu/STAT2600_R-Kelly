---
title: "Lab12"
author: "R Kelly"
date: "4/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(gapminder)
gapminder<- gapminder::gapminder
samp <- sample(gapminder$lifeExp,300, replace = FALSE)
view(samp)
group1 <- samp[1:3]
group2 <- samp[3+1:300]
```


```{r}
perm_mean <- function(perms = 1000, values, n1)
{
  ## Variables ##
  # perms: The number of permutations 
  # values (num): 
  # n1 (int): Size of group 1
  ###############
  vec <- numeric(1000)
  # Step 1:
  # Create vector of zeroes of length "perms" to store
  # permuted mean differnces
  
  
  
  # Loop throught number of permutations
  for (i in c(1:perms))
  {
    # Step 2:
    # Randomly separate vector "values" into disjoint 
    # groups of size "n1" and "length(values) - n1" respectively
    
    samp <- sample(gapminder$lifeExp,300, replace = FALSE)
    group1 <- samp[1:n1]
    group2 <- samp[n1+1:length(values)]
    
    # Step 3:
    # Compute the sample means for the two groups from 
    # step 2
    
    M1 = mean(group1)
    M2 = mean(group2)
    
    # Step 4: 
    # Compute the difference in sample means, store the
    # value in the vector from step 1
    
    diffmean = M1 - M2
    vec[i] <- diffmean
    
  }
  
  # Step 5:
  # Return new updated vector, created in step 1
  
}
```

```{r}
perm_mean <- function(1000, 300, 50)
```

```{r}
gap_by_cotinents <- gapminder %>% group_by(continent, country)
perm_cor <- function(perms = 1000, year, lifeExp)
{
  vector <- c(rep(0,perms))

  # Loop throught number of permutations
  for (i in c(1:perms))
  {
    # Step 2:
    # Randomly mix up the values in the vector "y"
    life_exp <- sample(lifeExp, length(lifeExp))
    
    # Step 3:
    # Compute the correlation between x and the randomly mixed
    # up y-vector. Store this value in the vector from step 1.
    vector[i] <- cor(life_exp, year)
  }
  
  # Step 4:
  # Return new updated vector, created in step 1
  return(vector)
}
```

```{r}
correlation <- perm_cor(perms = 1000, gapminder$year, gapminder$lifeExp)
plot(correlation)
histogram(correlation)
```